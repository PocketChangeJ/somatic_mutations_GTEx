pileup_file <- "pileup_wihtGermLine_Nerve.txt"

pileup <- read.table(pileup_file, sep = "\t", stringsAsFactors = F)
bases <- setNames(4:7, c("A", "T", "G", "C"))
bases_i <- 4:7
ref_i <- 9

# Append if true if there is only 2 alleles
pileup$bi_allelic <- rowSums(pileup[,bases_i] > 0) == 2

# Append alt counts
pileup$alt <- 0
for(i in 1:nrow(pileup)) {
    pileup$alt[i] <- sum(pileup[i, bases[names(bases) != pileup$V3[i]]])
}

# Append coverage
pileup$cov <- pileup$alt + piluep$V9

# Only select n and
n <- 6
coverage <- 40

current <- pileup[pileup$cov >= coverage & pileup$alt >= n,]

